function fetchChildrenArea(e,t,a){var c={url:"http://search.olp.yahooapis.jp/OpenLocalPlatform/V1/addressDirectory",appid:"dj0zaiZpPVJLbUJmOXppWXJrciZzPWNvbnN1bWVyc2VjcmV0Jng9ZDc-"},i=this;return i.cache=i.cache||{},i.cache[e]?void(t&&t(i.cache[e])):void $.ajax({url:c.url,data:{appid:c.appid,ac:e,mode:"2",output:"json"},dataType:"jsonp"}).done(function(c){var n,s,l,o;if(c.error)return void(a&&a());for(n=c,s=["Feature","0","Property","AddressDirectory"];n&&s.length;)n=n[s.shift()];if(!n||!n.length)return void(a&&a());for(l=0,o=n.length;o>l;)n[l]={ac:n[l].AreaCode,name:n[l].Name},l++;i.cache[e]=n,t&&t(n)}).fail(function(){a&&a()})}var $selects=$("select");"undefined"==typeof ac1_init_value&&(ac1_init_value=0);var setSelectOptions=function(e,t){var a,c,i=[];if(i.push("<option value=''>"+e.attr("data-label")+"</option>"),t)for(a=0,c=t.length;c>a;a++)init_select="",t[a].ac==ac1_init_value&&(init_select=" selected"),i.push("<option data-ac='"+t[a].ac+"' value='"+t[a].ac+"' id='select"+t[a].ac+"'"+init_select+">"+t[a].name+"</option>");1===i.length?e.hide():e.show(),e.html(i.join(""))};$selects.eq(0).change(function(){var e=$(this).find(":selected").attr("data-ac");e?fetchChildrenArea(e,function(e){setSelectOptions($selects.eq(1),e)}):setSelectOptions($selects.eq(1))}),$selects.eq(1).change(function(){var e=$(this).find(":selected").attr("data-ac");e&&fetchChildrenArea(e,function(){})}),fetchChildrenArea("JP",function(e){setSelectOptions($selects.eq(0),e),setSelectOptions($selects.eq(1)),"undefined"!=typeof ac0_init_value&&$selects.eq(0).val(ac0_init_value).trigger("change")});